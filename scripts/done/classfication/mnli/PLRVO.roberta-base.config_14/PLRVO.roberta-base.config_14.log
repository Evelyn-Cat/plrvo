[2024-12-31 05:30:58,114] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
running stars at 2024-12-31 05:30:58.818033
confirm imported PLRVO
 | tokenizer: RobertaTokenizer(name_or_path='roberta-base', vocab_size=50265, model_max_length=512, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': AddedToken("<s>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'eos_token': AddedToken("</s>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'unk_token': AddedToken("<unk>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'sep_token': AddedToken("</s>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'pad_token': AddedToken("<pad>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'cls_token': AddedToken("<s>", rstrip=False, lstrip=False, single_word=False, normalized=True), 'mask_token': AddedToken("<mask>", rstrip=False, lstrip=True, single_word=False, normalized=True)}, clean_up_tokenization_spaces=True), size: 50265 



 *** dataset sizes: 
train: 392702
valid: 9815
 ***
 | model type: 
<class 'transformers.models.roberta.modeling_roberta.RobertaForSequenceClassification'>
attention_only: False | randomly_initialize: False
Params to update: 
[
    "roberta.embeddings.word_embeddings.weight",
    "roberta.embeddings.position_embeddings.weight",
    "roberta.embeddings.token_type_embeddings.weight",
    "roberta.embeddings.LayerNorm.weight",
    "roberta.embeddings.LayerNorm.bias",
    "roberta.encoder.layer.0.attention.self.query.weight",
    "roberta.encoder.layer.0.attention.self.query.bias",
    "roberta.encoder.layer.0.attention.self.key.weight",
    "roberta.encoder.layer.0.attention.self.key.bias",
    "roberta.encoder.layer.0.attention.self.value.weight",
    "roberta.encoder.layer.0.attention.self.value.bias",
    "roberta.encoder.layer.0.attention.output.dense.weight",
    "roberta.encoder.layer.0.attention.output.dense.bias",
    "roberta.encoder.layer.0.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.0.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.0.intermediate.dense.weight",
    "roberta.encoder.layer.0.intermediate.dense.bias",
    "roberta.encoder.layer.0.output.dense.weight",
    "roberta.encoder.layer.0.output.dense.bias",
    "roberta.encoder.layer.0.output.LayerNorm.weight",
    "roberta.encoder.layer.0.output.LayerNorm.bias",
    "roberta.encoder.layer.1.attention.self.query.weight",
    "roberta.encoder.layer.1.attention.self.query.bias",
    "roberta.encoder.layer.1.attention.self.key.weight",
    "roberta.encoder.layer.1.attention.self.key.bias",
    "roberta.encoder.layer.1.attention.self.value.weight",
    "roberta.encoder.layer.1.attention.self.value.bias",
    "roberta.encoder.layer.1.attention.output.dense.weight",
    "roberta.encoder.layer.1.attention.output.dense.bias",
    "roberta.encoder.layer.1.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.1.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.1.intermediate.dense.weight",
    "roberta.encoder.layer.1.intermediate.dense.bias",
    "roberta.encoder.layer.1.output.dense.weight",
    "roberta.encoder.layer.1.output.dense.bias",
    "roberta.encoder.layer.1.output.LayerNorm.weight",
    "roberta.encoder.layer.1.output.LayerNorm.bias",
    "roberta.encoder.layer.2.attention.self.query.weight",
    "roberta.encoder.layer.2.attention.self.query.bias",
    "roberta.encoder.layer.2.attention.self.key.weight",
    "roberta.encoder.layer.2.attention.self.key.bias",
    "roberta.encoder.layer.2.attention.self.value.weight",
    "roberta.encoder.layer.2.attention.self.value.bias",
    "roberta.encoder.layer.2.attention.output.dense.weight",
    "roberta.encoder.layer.2.attention.output.dense.bias",
    "roberta.encoder.layer.2.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.2.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.2.intermediate.dense.weight",
    "roberta.encoder.layer.2.intermediate.dense.bias",
    "roberta.encoder.layer.2.output.dense.weight",
    "roberta.encoder.layer.2.output.dense.bias",
    "roberta.encoder.layer.2.output.LayerNorm.weight",
    "roberta.encoder.layer.2.output.LayerNorm.bias",
    "roberta.encoder.layer.3.attention.self.query.weight",
    "roberta.encoder.layer.3.attention.self.query.bias",
    "roberta.encoder.layer.3.attention.self.key.weight",
    "roberta.encoder.layer.3.attention.self.key.bias",
    "roberta.encoder.layer.3.attention.self.value.weight",
    "roberta.encoder.layer.3.attention.self.value.bias",
    "roberta.encoder.layer.3.attention.output.dense.weight",
    "roberta.encoder.layer.3.attention.output.dense.bias",
    "roberta.encoder.layer.3.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.3.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.3.intermediate.dense.weight",
    "roberta.encoder.layer.3.intermediate.dense.bias",
    "roberta.encoder.layer.3.output.dense.weight",
    "roberta.encoder.layer.3.output.dense.bias",
    "roberta.encoder.layer.3.output.LayerNorm.weight",
    "roberta.encoder.layer.3.output.LayerNorm.bias",
    "roberta.encoder.layer.4.attention.self.query.weight",
    "roberta.encoder.layer.4.attention.self.query.bias",
    "roberta.encoder.layer.4.attention.self.key.weight",
    "roberta.encoder.layer.4.attention.self.key.bias",
    "roberta.encoder.layer.4.attention.self.value.weight",
    "roberta.encoder.layer.4.attention.self.value.bias",
    "roberta.encoder.layer.4.attention.output.dense.weight",
    "roberta.encoder.layer.4.attention.output.dense.bias",
    "roberta.encoder.layer.4.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.4.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.4.intermediate.dense.weight",
    "roberta.encoder.layer.4.intermediate.dense.bias",
    "roberta.encoder.layer.4.output.dense.weight",
    "roberta.encoder.layer.4.output.dense.bias",
    "roberta.encoder.layer.4.output.LayerNorm.weight",
    "roberta.encoder.layer.4.output.LayerNorm.bias",
    "roberta.encoder.layer.5.attention.self.query.weight",
    "roberta.encoder.layer.5.attention.self.query.bias",
    "roberta.encoder.layer.5.attention.self.key.weight",
    "roberta.encoder.layer.5.attention.self.key.bias",
    "roberta.encoder.layer.5.attention.self.value.weight",
    "roberta.encoder.layer.5.attention.self.value.bias",
    "roberta.encoder.layer.5.attention.output.dense.weight",
    "roberta.encoder.layer.5.attention.output.dense.bias",
    "roberta.encoder.layer.5.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.5.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.5.intermediate.dense.weight",
    "roberta.encoder.layer.5.intermediate.dense.bias",
    "roberta.encoder.layer.5.output.dense.weight",
    "roberta.encoder.layer.5.output.dense.bias",
    "roberta.encoder.layer.5.output.LayerNorm.weight",
    "roberta.encoder.layer.5.output.LayerNorm.bias",
    "roberta.encoder.layer.6.attention.self.query.weight",
    "roberta.encoder.layer.6.attention.self.query.bias",
    "roberta.encoder.layer.6.attention.self.key.weight",
    "roberta.encoder.layer.6.attention.self.key.bias",
    "roberta.encoder.layer.6.attention.self.value.weight",
    "roberta.encoder.layer.6.attention.self.value.bias",
    "roberta.encoder.layer.6.attention.output.dense.weight",
    "roberta.encoder.layer.6.attention.output.dense.bias",
    "roberta.encoder.layer.6.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.6.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.6.intermediate.dense.weight",
    "roberta.encoder.layer.6.intermediate.dense.bias",
    "roberta.encoder.layer.6.output.dense.weight",
    "roberta.encoder.layer.6.output.dense.bias",
    "roberta.encoder.layer.6.output.LayerNorm.weight",
    "roberta.encoder.layer.6.output.LayerNorm.bias",
    "roberta.encoder.layer.7.attention.self.query.weight",
    "roberta.encoder.layer.7.attention.self.query.bias",
    "roberta.encoder.layer.7.attention.self.key.weight",
    "roberta.encoder.layer.7.attention.self.key.bias",
    "roberta.encoder.layer.7.attention.self.value.weight",
    "roberta.encoder.layer.7.attention.self.value.bias",
    "roberta.encoder.layer.7.attention.output.dense.weight",
    "roberta.encoder.layer.7.attention.output.dense.bias",
    "roberta.encoder.layer.7.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.7.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.7.intermediate.dense.weight",
    "roberta.encoder.layer.7.intermediate.dense.bias",
    "roberta.encoder.layer.7.output.dense.weight",
    "roberta.encoder.layer.7.output.dense.bias",
    "roberta.encoder.layer.7.output.LayerNorm.weight",
    "roberta.encoder.layer.7.output.LayerNorm.bias",
    "roberta.encoder.layer.8.attention.self.query.weight",
    "roberta.encoder.layer.8.attention.self.query.bias",
    "roberta.encoder.layer.8.attention.self.key.weight",
    "roberta.encoder.layer.8.attention.self.key.bias",
    "roberta.encoder.layer.8.attention.self.value.weight",
    "roberta.encoder.layer.8.attention.self.value.bias",
    "roberta.encoder.layer.8.attention.output.dense.weight",
    "roberta.encoder.layer.8.attention.output.dense.bias",
    "roberta.encoder.layer.8.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.8.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.8.intermediate.dense.weight",
    "roberta.encoder.layer.8.intermediate.dense.bias",
    "roberta.encoder.layer.8.output.dense.weight",
    "roberta.encoder.layer.8.output.dense.bias",
    "roberta.encoder.layer.8.output.LayerNorm.weight",
    "roberta.encoder.layer.8.output.LayerNorm.bias",
    "roberta.encoder.layer.9.attention.self.query.weight",
    "roberta.encoder.layer.9.attention.self.query.bias",
    "roberta.encoder.layer.9.attention.self.key.weight",
    "roberta.encoder.layer.9.attention.self.key.bias",
    "roberta.encoder.layer.9.attention.self.value.weight",
    "roberta.encoder.layer.9.attention.self.value.bias",
    "roberta.encoder.layer.9.attention.output.dense.weight",
    "roberta.encoder.layer.9.attention.output.dense.bias",
    "roberta.encoder.layer.9.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.9.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.9.intermediate.dense.weight",
    "roberta.encoder.layer.9.intermediate.dense.bias",
    "roberta.encoder.layer.9.output.dense.weight",
    "roberta.encoder.layer.9.output.dense.bias",
    "roberta.encoder.layer.9.output.LayerNorm.weight",
    "roberta.encoder.layer.9.output.LayerNorm.bias",
    "roberta.encoder.layer.10.attention.self.query.weight",
    "roberta.encoder.layer.10.attention.self.query.bias",
    "roberta.encoder.layer.10.attention.self.key.weight",
    "roberta.encoder.layer.10.attention.self.key.bias",
    "roberta.encoder.layer.10.attention.self.value.weight",
    "roberta.encoder.layer.10.attention.self.value.bias",
    "roberta.encoder.layer.10.attention.output.dense.weight",
    "roberta.encoder.layer.10.attention.output.dense.bias",
    "roberta.encoder.layer.10.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.10.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.10.intermediate.dense.weight",
    "roberta.encoder.layer.10.intermediate.dense.bias",
    "roberta.encoder.layer.10.output.dense.weight",
    "roberta.encoder.layer.10.output.dense.bias",
    "roberta.encoder.layer.10.output.LayerNorm.weight",
    "roberta.encoder.layer.10.output.LayerNorm.bias",
    "roberta.encoder.layer.11.attention.self.query.weight",
    "roberta.encoder.layer.11.attention.self.query.bias",
    "roberta.encoder.layer.11.attention.self.key.weight",
    "roberta.encoder.layer.11.attention.self.key.bias",
    "roberta.encoder.layer.11.attention.self.value.weight",
    "roberta.encoder.layer.11.attention.self.value.bias",
    "roberta.encoder.layer.11.attention.output.dense.weight",
    "roberta.encoder.layer.11.attention.output.dense.bias",
    "roberta.encoder.layer.11.attention.output.LayerNorm.weight",
    "roberta.encoder.layer.11.attention.output.LayerNorm.bias",
    "roberta.encoder.layer.11.intermediate.dense.weight",
    "roberta.encoder.layer.11.intermediate.dense.bias",
    "roberta.encoder.layer.11.output.dense.weight",
    "roberta.encoder.layer.11.output.dense.bias",
    "roberta.encoder.layer.11.output.LayerNorm.weight",
    "roberta.encoder.layer.11.output.LayerNorm.bias",
    "classifier.dense.weight",
    "classifier.dense.bias",
    "classifier.out_proj.weight",
    "classifier.out_proj.bias"
]
Number of differentiable params: 124.648 million
per_example_max_grad_norm is 1.27586206896552 [self.max_grad_norm]
{'a_G': 1, 'G_k': 53.0653266331658, 'G_theta': 0.0158332201548282, 'distributions': ['Gamma'], 'steps': 197, 'eps': 0.922877680843546, 'PLRV-Dist': 1.21305963650293, 'delta': 7.42401520438314e-06, 'C': 1.27586206896552, 'sample_rate': 0.0152043831385767, 'Gauss_distortion': 1.37056798758602, 'noise_multiplier': 1.3520751953125, 'sigma': 1.725061456088366}
0
0
privacy_args: 
{
    "noise_type": "PLRVO",
    "config_idx": 14,
    "per_example_max_grad_norm": 0.1,
    "noise_multiplier": 0,
    "target_epsilon": 0,
    "target_delta": 1.2732300828618139e-06,
    "non_private": false,
    "accounting_mode": "rdp",
    "clipping_mode": "ghost"
}
{'contradiction': 'no', 'entailment': 'yes', 'neutral': 'maybe'}
*cls**sent-_0*?*mask*,*+sentl_1**sep+*
2: -1
2: 2311 7 3.0
metrics: 
{
    "eval_loss": 1.0977888107299805,
    "eval_mnli/acc": 0.3543555781966378
}
dev objective eval_mnli/acc: 0.3543555781966378
metrics: 
{
    "eval_loss": 1.4079424142837524,
    "eval_mnli/acc": 0.8250636780438105
}
dev objective eval_mnli/acc: 0.8250636780438105
metrics: 
{
    "eval_loss": 1.2834748029708862,
    "eval_mnli/acc": 0.8428935303107489
}
dev objective eval_mnli/acc: 0.8428935303107489
metrics: 
{
    "eval_loss": 1.2628360986709595,
    "eval_mnli/acc": 0.853998981151299
}
dev objective eval_mnli/acc: 0.853998981151299
metrics: 
{
    "eval_loss": 1.2169569730758667,
    "eval_mnli/acc": 0.8600101884870097
}
dev objective eval_mnli/acc: 0.8600101884870097
metrics: 
{
    "eval_loss": 1.2056338787078857,
    "eval_mnli/acc": 0.8612328069281712
}
dev objective eval_mnli/acc: 0.8612328069281712
metrics: 
{
    "eval_loss": 1.1926262378692627,
    "eval_mnli/acc": 0.8595007641365258
}
dev objective eval_mnli/acc: 0.8595007641365258
metrics: 
{
    "eval_loss": 1.2441452741622925,
    "eval_mnli/acc": 0.8658176260825268
}
dev objective eval_mnli/acc: 0.8658176260825268
metrics: 
{
    "eval_loss": 1.2774780988693237,
    "eval_mnli/acc": 0.8631686194600102
}
dev objective eval_mnli/acc: 0.8631686194600102
metrics: 
{
    "eval_loss": 1.2349895238876343,
    "eval_mnli/acc": 0.8675496688741722
}
dev objective eval_mnli/acc: 0.8675496688741722
metrics: 
{
    "eval_loss": 1.2388057708740234,
    "eval_mnli/acc": 0.8682628629648497
}
dev objective eval_mnli/acc: 0.8682628629648497
running time: 19598.26 seconds... [about 5.44396225353082 hours]
no
learning rate is 5e-05
Running command:

CUDA_VISIBLE_DEVICES=0 python -m classification.run_classification_final   --per_device_train_batch_size 170   --task_name mnli --model_name_or_path roberta-base   --noise_type PLRVO --config_idx 14   --non_private no --output_dir /mnt/backup/home/qiy22005/PRO/plrvo/scripts/results/classification/mnli/PLRVO.roberta-base.config_14 --overwrite_output_dir   --gradient_accumulation_steps 7 --num_train_epochs 3   --learning_rate 5e-05 --clipping_mode ghost --few_shot_type finetune --data_dir classification/data/original/MNLI   --seed 42 --randomly_initialize no --store_grads no --template *cls**sent-_0*?*mask*,*+sentl_1**sep+*   --attention_only no --static_lm_head no --static_embedding no   --eval_steps 100 --eval_spectrum no --max_spectrum_batches 2 --max_lanczos_iter 2   --weight_decay 0 --lr_decay no --adam_epsilon 1e-08 --max_seq_len 256 --per_device_eval_batch_size 100   --evaluation_strategy steps --evaluate_before_training True --do_train --do_eval --num_sample 1 --num_k 1   --first_sent_limit 200 --other_sent_limit 200 --truncate_head yes 

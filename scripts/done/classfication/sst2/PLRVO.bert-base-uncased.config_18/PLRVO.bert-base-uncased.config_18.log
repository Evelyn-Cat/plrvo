running stars at 2024-12-31 17:44:37.768044
confirm imported PLRVO
 | tokenizer: BertTokenizer(name_or_path='bert-base-uncased', vocab_size=30522, model_max_length=512, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'}, clean_up_tokenization_spaces=True),  added_tokens_decoder={
	0: AddedToken("[PAD]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	100: AddedToken("[UNK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	101: AddedToken("[CLS]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	102: AddedToken("[SEP]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	103: AddedToken("[MASK]", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}, size: 30522 



 *** dataset sizes: 
train: 67349
valid: 872
 ***
 | model type: 
<class 'transformers.models.bert.modeling_bert.BertForSequenceClassification'>
attention_only: False | randomly_initialize: False
Params to update: 
[
    "bert.embeddings.word_embeddings.weight",
    "bert.embeddings.position_embeddings.weight",
    "bert.embeddings.token_type_embeddings.weight",
    "bert.embeddings.LayerNorm.weight",
    "bert.embeddings.LayerNorm.bias",
    "bert.encoder.layer.0.attention.self.query.weight",
    "bert.encoder.layer.0.attention.self.query.bias",
    "bert.encoder.layer.0.attention.self.key.weight",
    "bert.encoder.layer.0.attention.self.key.bias",
    "bert.encoder.layer.0.attention.self.value.weight",
    "bert.encoder.layer.0.attention.self.value.bias",
    "bert.encoder.layer.0.attention.output.dense.weight",
    "bert.encoder.layer.0.attention.output.dense.bias",
    "bert.encoder.layer.0.attention.output.LayerNorm.weight",
    "bert.encoder.layer.0.attention.output.LayerNorm.bias",
    "bert.encoder.layer.0.intermediate.dense.weight",
    "bert.encoder.layer.0.intermediate.dense.bias",
    "bert.encoder.layer.0.output.dense.weight",
    "bert.encoder.layer.0.output.dense.bias",
    "bert.encoder.layer.0.output.LayerNorm.weight",
    "bert.encoder.layer.0.output.LayerNorm.bias",
    "bert.encoder.layer.1.attention.self.query.weight",
    "bert.encoder.layer.1.attention.self.query.bias",
    "bert.encoder.layer.1.attention.self.key.weight",
    "bert.encoder.layer.1.attention.self.key.bias",
    "bert.encoder.layer.1.attention.self.value.weight",
    "bert.encoder.layer.1.attention.self.value.bias",
    "bert.encoder.layer.1.attention.output.dense.weight",
    "bert.encoder.layer.1.attention.output.dense.bias",
    "bert.encoder.layer.1.attention.output.LayerNorm.weight",
    "bert.encoder.layer.1.attention.output.LayerNorm.bias",
    "bert.encoder.layer.1.intermediate.dense.weight",
    "bert.encoder.layer.1.intermediate.dense.bias",
    "bert.encoder.layer.1.output.dense.weight",
    "bert.encoder.layer.1.output.dense.bias",
    "bert.encoder.layer.1.output.LayerNorm.weight",
    "bert.encoder.layer.1.output.LayerNorm.bias",
    "bert.encoder.layer.2.attention.self.query.weight",
    "bert.encoder.layer.2.attention.self.query.bias",
    "bert.encoder.layer.2.attention.self.key.weight",
    "bert.encoder.layer.2.attention.self.key.bias",
    "bert.encoder.layer.2.attention.self.value.weight",
    "bert.encoder.layer.2.attention.self.value.bias",
    "bert.encoder.layer.2.attention.output.dense.weight",
    "bert.encoder.layer.2.attention.output.dense.bias",
    "bert.encoder.layer.2.attention.output.LayerNorm.weight",
    "bert.encoder.layer.2.attention.output.LayerNorm.bias",
    "bert.encoder.layer.2.intermediate.dense.weight",
    "bert.encoder.layer.2.intermediate.dense.bias",
    "bert.encoder.layer.2.output.dense.weight",
    "bert.encoder.layer.2.output.dense.bias",
    "bert.encoder.layer.2.output.LayerNorm.weight",
    "bert.encoder.layer.2.output.LayerNorm.bias",
    "bert.encoder.layer.3.attention.self.query.weight",
    "bert.encoder.layer.3.attention.self.query.bias",
    "bert.encoder.layer.3.attention.self.key.weight",
    "bert.encoder.layer.3.attention.self.key.bias",
    "bert.encoder.layer.3.attention.self.value.weight",
    "bert.encoder.layer.3.attention.self.value.bias",
    "bert.encoder.layer.3.attention.output.dense.weight",
    "bert.encoder.layer.3.attention.output.dense.bias",
    "bert.encoder.layer.3.attention.output.LayerNorm.weight",
    "bert.encoder.layer.3.attention.output.LayerNorm.bias",
    "bert.encoder.layer.3.intermediate.dense.weight",
    "bert.encoder.layer.3.intermediate.dense.bias",
    "bert.encoder.layer.3.output.dense.weight",
    "bert.encoder.layer.3.output.dense.bias",
    "bert.encoder.layer.3.output.LayerNorm.weight",
    "bert.encoder.layer.3.output.LayerNorm.bias",
    "bert.encoder.layer.4.attention.self.query.weight",
    "bert.encoder.layer.4.attention.self.query.bias",
    "bert.encoder.layer.4.attention.self.key.weight",
    "bert.encoder.layer.4.attention.self.key.bias",
    "bert.encoder.layer.4.attention.self.value.weight",
    "bert.encoder.layer.4.attention.self.value.bias",
    "bert.encoder.layer.4.attention.output.dense.weight",
    "bert.encoder.layer.4.attention.output.dense.bias",
    "bert.encoder.layer.4.attention.output.LayerNorm.weight",
    "bert.encoder.layer.4.attention.output.LayerNorm.bias",
    "bert.encoder.layer.4.intermediate.dense.weight",
    "bert.encoder.layer.4.intermediate.dense.bias",
    "bert.encoder.layer.4.output.dense.weight",
    "bert.encoder.layer.4.output.dense.bias",
    "bert.encoder.layer.4.output.LayerNorm.weight",
    "bert.encoder.layer.4.output.LayerNorm.bias",
    "bert.encoder.layer.5.attention.self.query.weight",
    "bert.encoder.layer.5.attention.self.query.bias",
    "bert.encoder.layer.5.attention.self.key.weight",
    "bert.encoder.layer.5.attention.self.key.bias",
    "bert.encoder.layer.5.attention.self.value.weight",
    "bert.encoder.layer.5.attention.self.value.bias",
    "bert.encoder.layer.5.attention.output.dense.weight",
    "bert.encoder.layer.5.attention.output.dense.bias",
    "bert.encoder.layer.5.attention.output.LayerNorm.weight",
    "bert.encoder.layer.5.attention.output.LayerNorm.bias",
    "bert.encoder.layer.5.intermediate.dense.weight",
    "bert.encoder.layer.5.intermediate.dense.bias",
    "bert.encoder.layer.5.output.dense.weight",
    "bert.encoder.layer.5.output.dense.bias",
    "bert.encoder.layer.5.output.LayerNorm.weight",
    "bert.encoder.layer.5.output.LayerNorm.bias",
    "bert.encoder.layer.6.attention.self.query.weight",
    "bert.encoder.layer.6.attention.self.query.bias",
    "bert.encoder.layer.6.attention.self.key.weight",
    "bert.encoder.layer.6.attention.self.key.bias",
    "bert.encoder.layer.6.attention.self.value.weight",
    "bert.encoder.layer.6.attention.self.value.bias",
    "bert.encoder.layer.6.attention.output.dense.weight",
    "bert.encoder.layer.6.attention.output.dense.bias",
    "bert.encoder.layer.6.attention.output.LayerNorm.weight",
    "bert.encoder.layer.6.attention.output.LayerNorm.bias",
    "bert.encoder.layer.6.intermediate.dense.weight",
    "bert.encoder.layer.6.intermediate.dense.bias",
    "bert.encoder.layer.6.output.dense.weight",
    "bert.encoder.layer.6.output.dense.bias",
    "bert.encoder.layer.6.output.LayerNorm.weight",
    "bert.encoder.layer.6.output.LayerNorm.bias",
    "bert.encoder.layer.7.attention.self.query.weight",
    "bert.encoder.layer.7.attention.self.query.bias",
    "bert.encoder.layer.7.attention.self.key.weight",
    "bert.encoder.layer.7.attention.self.key.bias",
    "bert.encoder.layer.7.attention.self.value.weight",
    "bert.encoder.layer.7.attention.self.value.bias",
    "bert.encoder.layer.7.attention.output.dense.weight",
    "bert.encoder.layer.7.attention.output.dense.bias",
    "bert.encoder.layer.7.attention.output.LayerNorm.weight",
    "bert.encoder.layer.7.attention.output.LayerNorm.bias",
    "bert.encoder.layer.7.intermediate.dense.weight",
    "bert.encoder.layer.7.intermediate.dense.bias",
    "bert.encoder.layer.7.output.dense.weight",
    "bert.encoder.layer.7.output.dense.bias",
    "bert.encoder.layer.7.output.LayerNorm.weight",
    "bert.encoder.layer.7.output.LayerNorm.bias",
    "bert.encoder.layer.8.attention.self.query.weight",
    "bert.encoder.layer.8.attention.self.query.bias",
    "bert.encoder.layer.8.attention.self.key.weight",
    "bert.encoder.layer.8.attention.self.key.bias",
    "bert.encoder.layer.8.attention.self.value.weight",
    "bert.encoder.layer.8.attention.self.value.bias",
    "bert.encoder.layer.8.attention.output.dense.weight",
    "bert.encoder.layer.8.attention.output.dense.bias",
    "bert.encoder.layer.8.attention.output.LayerNorm.weight",
    "bert.encoder.layer.8.attention.output.LayerNorm.bias",
    "bert.encoder.layer.8.intermediate.dense.weight",
    "bert.encoder.layer.8.intermediate.dense.bias",
    "bert.encoder.layer.8.output.dense.weight",
    "bert.encoder.layer.8.output.dense.bias",
    "bert.encoder.layer.8.output.LayerNorm.weight",
    "bert.encoder.layer.8.output.LayerNorm.bias",
    "bert.encoder.layer.9.attention.self.query.weight",
    "bert.encoder.layer.9.attention.self.query.bias",
    "bert.encoder.layer.9.attention.self.key.weight",
    "bert.encoder.layer.9.attention.self.key.bias",
    "bert.encoder.layer.9.attention.self.value.weight",
    "bert.encoder.layer.9.attention.self.value.bias",
    "bert.encoder.layer.9.attention.output.dense.weight",
    "bert.encoder.layer.9.attention.output.dense.bias",
    "bert.encoder.layer.9.attention.output.LayerNorm.weight",
    "bert.encoder.layer.9.attention.output.LayerNorm.bias",
    "bert.encoder.layer.9.intermediate.dense.weight",
    "bert.encoder.layer.9.intermediate.dense.bias",
    "bert.encoder.layer.9.output.dense.weight",
    "bert.encoder.layer.9.output.dense.bias",
    "bert.encoder.layer.9.output.LayerNorm.weight",
    "bert.encoder.layer.9.output.LayerNorm.bias",
    "bert.encoder.layer.10.attention.self.query.weight",
    "bert.encoder.layer.10.attention.self.query.bias",
    "bert.encoder.layer.10.attention.self.key.weight",
    "bert.encoder.layer.10.attention.self.key.bias",
    "bert.encoder.layer.10.attention.self.value.weight",
    "bert.encoder.layer.10.attention.self.value.bias",
    "bert.encoder.layer.10.attention.output.dense.weight",
    "bert.encoder.layer.10.attention.output.dense.bias",
    "bert.encoder.layer.10.attention.output.LayerNorm.weight",
    "bert.encoder.layer.10.attention.output.LayerNorm.bias",
    "bert.encoder.layer.10.intermediate.dense.weight",
    "bert.encoder.layer.10.intermediate.dense.bias",
    "bert.encoder.layer.10.output.dense.weight",
    "bert.encoder.layer.10.output.dense.bias",
    "bert.encoder.layer.10.output.LayerNorm.weight",
    "bert.encoder.layer.10.output.LayerNorm.bias",
    "bert.encoder.layer.11.attention.self.query.weight",
    "bert.encoder.layer.11.attention.self.query.bias",
    "bert.encoder.layer.11.attention.self.key.weight",
    "bert.encoder.layer.11.attention.self.key.bias",
    "bert.encoder.layer.11.attention.self.value.weight",
    "bert.encoder.layer.11.attention.self.value.bias",
    "bert.encoder.layer.11.attention.output.dense.weight",
    "bert.encoder.layer.11.attention.output.dense.bias",
    "bert.encoder.layer.11.attention.output.LayerNorm.weight",
    "bert.encoder.layer.11.attention.output.LayerNorm.bias",
    "bert.encoder.layer.11.intermediate.dense.weight",
    "bert.encoder.layer.11.intermediate.dense.bias",
    "bert.encoder.layer.11.output.dense.weight",
    "bert.encoder.layer.11.output.dense.bias",
    "bert.encoder.layer.11.output.LayerNorm.weight",
    "bert.encoder.layer.11.output.LayerNorm.bias",
    "bert.pooler.dense.weight",
    "bert.pooler.dense.bias",
    "classifier.weight",
    "classifier.bias"
]
Number of differentiable params: 109.484 million
per_example_max_grad_norm is 1.2758620689655173 [self.max_grad_norm]
{'target_epsilon': 1.1106900682684355, 'distortion_PLRV': 1.0180639391931852, 'target_delta': 7.4240152043831385e-06, 'C': 1.2758620689655173, 'sample_rate': 0.015204383138576668, 'G_k': 126.53266331658291, 'G_theta': 0.007824709131241794, 'steps': 197.0, 'distortion': 1.264081478513352, 'rdp_order': 150.0, 'noise_multiplier': 1.23876953125, 'sigma': 1.5804990571120692}
0
0
privacy_args: 
{
    "noise_type": "PLRVO",
    "config_idx": 18,
    "per_example_max_grad_norm": 0.1,
    "noise_multiplier": 0,
    "target_epsilon": 0,
    "target_delta": 7.4240152043831385e-06,
    "non_private": false,
    "accounting_mode": "rdp",
    "clipping_mode": "ghost"
}
{'0':'terrible','1':'great'}
*cls**sent_0*_It_was*mask*.*sep+*
2: -1
2: 225 4 3.0
metrics: 
{
    "eval_loss": -98.96076202392578,
    "eval_acc": 0.5091743119266054
}
dev objective eval_acc: 0.5091743119266054
metrics: 
{
    "eval_loss": -98.95945739746094,
    "eval_acc": 0.9059633027522935
}
dev objective eval_acc: 0.9059633027522935
metrics: 
{
    "eval_loss": -98.95963287353516,
    "eval_acc": 0.9139908256880734
}
dev objective eval_acc: 0.9139908256880734
running time: 1768.01 seconds... [about 0.49111263904306623 hours]
no
learning rate is 5e-05
Running command:

CUDA_VISIBLE_DEVICES=1 python -m classification.run_classification_final   --per_device_train_batch_size 300   --task_name sst-2 --model_name_or_path bert-base-uncased   --noise_type PLRVO --config_idx 18   --non_private no --output_dir /mnt/backup/home/qiy22005/PRO/plrvo/scripts/results/classification/sst2/PLRVO.bert-base-uncased.config_18 --overwrite_output_dir   --gradient_accumulation_steps 4 --num_train_epochs 3   --learning_rate 5e-05 --clipping_mode ghost --few_shot_type finetune --data_dir classification/data/original/GLUE-SST-2   --seed 42 --randomly_initialize no --store_grads no --template *cls**sent_0*_It_was*mask*.*sep+*   --attention_only no --static_lm_head no --static_embedding no   --eval_steps 100 --eval_spectrum no --max_spectrum_batches 2 --max_lanczos_iter 2   --weight_decay 0 --lr_decay no --adam_epsilon 1e-08 --max_seq_len 256 --per_device_eval_batch_size 100   --evaluation_strategy steps --evaluate_before_training True --do_train --do_eval --num_sample 1 --num_k 1   --first_sent_limit 200 --other_sent_limit 200 --truncate_head yes 
